# Smart Pandoc Debugger - Version 1.0.0 (TODO)

## Core Error Detection
- [ ] When user has unclosed `$` or `\(` in document, report exact location and suggest adding closing delimiter
- [ ] When special LaTeX characters (`&`, `%`, `#`, `_`, `^`, `~`, `\`) appear in text without proper escaping, suggest escaping with `\`
- [ ] For every `\begin{env}`, verify there's a matching `\end{env}` with the same environment name
- [ ] When `\command{...}` is used, verify command is defined in standard LaTeX or common packages
- [ ] When document contains non-ASCII characters that commonly cause issues (e.g., smart quotes), suggest replacements
- [ ] For every opening `{`, `[`, or `(`, ensure there's a matching closing character
- [ ] When URL or email is malformed (e.g., `user@domain` without TLD), flag as potentially problematic
- [ ] When `[text](link)` points to non-existent section or file, report broken link
- [ ] Flag Markdown syntax that doesn't match CommonMark spec (e.g., inconsistent list markers)

## Math Mode Support
- [ ] For `$...$` and `\(...\)` delimiters, ensure content is valid LaTeX math
- [ ] For `$$...$$` and `\[...\]` delimiters, ensure content is valid LaTeX display math
- [ ] In math mode, flag common errors like `\frac{1}{2` (unclosed brace) or `x^23` (missing braces)
- [ ] For `\begin{align}...\end{align}`, verify:
  - Each `&` alignment character has matching `&` on same line
  - Each line ends with `\\`
  - No empty lines inside environment
- [ ] When `\label{eq:...}` is used in math, ensure there's a corresponding `\ref{eq:...}` or `\eqref{eq:...}`
- [ ] When `\ref{eq:...}` or `\eqref{eq:...}` is used, ensure corresponding label exists
- [ ] In math mode, flag common errors like `\sinx` (should be `\sin x`) or `\left(` without `\right)`

## Code Block Handling
- [ ] For triple-backtick code blocks, ensure there's a matching set of backticks to close it
- [ ] When code block uses 4-space indentation, ensure all lines in block are indented consistently
- [ ] For nested code blocks (e.g., markdown in HTML in markdown), properly parse and validate each level
- [ ] When code block starts with ` ```language `, verify language is supported by syntax highlighter
- [ ] For indented code blocks, ensure consistent indentation (spaces only or tabs only, not mixed)

## Reference & Citation Validation
- [ ] For `[text](#anchor)`, verify `#anchor` exists in document as `## Heading {#anchor}` or similar
- [ ] When `\ref{sec:label}` is used, ensure corresponding `\label{sec:label}` exists
- [ ] For `[@citation]`, verify key exists in bibliography
- [ ] When same label is used multiple times (e.g., `\label{fig:1}`), report duplicates
- [ ] When `\cite{key}` is used but key doesn't appear in any citation, flag as potentially unused
- [ ] When `\ref{}` or `\cite{}` is empty, suggest possible labels/keys from document

## Document Structure
- [ ] When heading level jumps (e.g., `##` to `####` without `###` in between), suggest fixing hierarchy
- [ ] For lists, ensure consistent bullet/numbering style and indentation
- [ ] In tables, ensure all rows have same number of columns and proper alignment
- [ ] For `![alt](path.png)`, verify image file exists at specified path
- [ ] When section contains only whitespace or comments, suggest removing or adding content
- [ ] When paragraph exceeds 80 characters (configurable), suggest breaking into multiple paragraphs

## Common LaTeX Gotchas
- [ ] Detect and fix unescaped special characters in text:
  - `&` → `\&` in tables
  - `%` → `\%` in text
  - `#` → `\#` in text
  - `_` → `\_` in text
  - `^` → `\^` in text
  - `~` → `\~` or `\textasciitilde`
  - `\` → `\textbackslash`

- [ ] Find and fix common math mode issues:
  - `x^23` → `x^{23}` (missing braces)
  - `\frac{1}{2` → `\frac{1}{2}` (unclosed fraction)
  - `\left(` without `\right)`
  - `\left[` with `\right)` (mismatched delimiters)
  - `e^{x^2}` → `e^{x^{2}}` (nested exponents need braces)
  - `\text` without `amsmath` package

- [ ] Catch environment issues:
  ```
  \begin{figure}
    \includegraphics{image}
    \caption{My image}  % Missing \label
  \end{figure}
  % Later: \ref{fig:image}  % Undefined reference
  ```

- [ ] Detect and fix common table issues:
  - Missing `\hline` after `\endhead` in longtable
  - Unescaped `&` in table cells
  - Inconsistent number of columns
  - Missing `\\` at end of row

- [ ] Find problematic whitespace:
  - Multiple spaces (except in verbatim)
  - Tabs used for alignment
  - Inconsistent line endings
  - Trailing whitespace

- [ ] Check for missing packages:
  - `\usepackage{amsmath}` for `\text`, `\DeclareMathOperator`
  - `\usepackage{graphicx}` for `\includegraphics`
  - `\usepackage{hyperref}` for `\url`, `\href`
  - `\usepackage{booktabs}` for `\toprule`, `\midrule`, `\bottomrule`

- [ ] Detect common citation issues:
  - `\cite{key}` with undefined key
  - Duplicate citation keys
  - Missing `\bibliography{refs}`
  - `\citep` vs `\citet` misuse

- [ ] Find problematic special characters:
  - Smart quotes "..." → `"..."` or ```...''`
  - Em dash — → `---` or `\textemdash`
  - En dash – → `--` or `\textendash`
  - Non-breaking space ` ` → `~`

- [ ] Check for common command typos:
  - `\centering` → `\centering` (not `\center`)
  - `\usepackage` → `\usepackage` (not `\uspackage`)
  - `\documentclass` → `\documentclass` (not `\document`)
  - `\section{}` → `\section{}` (not `\section`)

- [ ] Detect figure/table placement issues:
  - Missing `\label` after `\caption`
  - `\ref` to non-existent label
  - Labels without captions
  - Captions without labels

- [ ] Find problematic math expressions:
  - `sin(x)` → `\sin(x)`
  - `lim_{x\to 0}` → `\lim_{x\to 0}`
  - `max`, `min`, `log` without `\`
  - Inconsistent bracket sizes with `\bigl`, `\Bigl`, etc.

## Error Reporting
- [ ] For each error, include:
  - File name and line number
  - Snippet of problematic code
  - Clear explanation of issue
  - Suggested fix when possible
- [ ] For common errors, provide one-command fixes (e.g., "Add closing $")
- [ ] For complex issues, link to relevant documentation with more details
- [ ] Group related errors (e.g., all math mode errors) when they're likely related

## Testing & Validation
- [ ] 100% test coverage for all error detection code paths
- [ ] Test suite includes real documents from common Pandoc/LaTeX workflows

## ➡️ Future Versions
For additional features and enhancements, see [V2.0.md](V2.0.md) and [V99.md](V99.md).
